{"files":[{"id":"c190e398-8648-4c1e-9852-2c83f694158b","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Tokyo\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"57df328e-fdf6-4193-af47-91fcf4af1e30","name":"change_cell_color","type":"server_js","source":"\nfunction change_cell_color_from_word(sh, value, cell, color, range){\n  // セル cell の値 が value であるとき 範囲 range 内のセルの色を colorにする\n  var cell_value \u003d sh.getRange(cell).getValue()\n  var rng \u003d sh.getRange(range);\n  if (cell_value \u003d\u003d value){\n    rng.setBackground(color);　//セル色を設定\n  }\n  else{\n    rng.setBackground(null);　//セル色を設定\n  }\n}\n\n\nfunction change_column_color_from_cell(sh, value, check_cell, color){\n  var cell_value \u003d sh.getRange(check_cell).getValue()\n  var right_end \u003d sh.getLastRow()\n  var column \u003d check_cell.match(/[0-9]{1,}/)[0]\n  var row \u003d check_cell.match(/[A-Za-z]{1,}/)[0]\n  var rng\u003dsh.getRange(column, 1, 1, right_end)\n  if (cell_value \u003d\u003d value){\n    rng.setBackground(color);　//セル色を設定\n  }\n  else{\n    rng.setBackground(null);　//セル色を設定\n  }\n  \n}\n\nfunction change_row_color_from_cell(sh, value, check_cell, color){\n  var cell_value \u003d sh.getRange(check_cell).getValue()\n  var bottom_end \u003d  sh.getLastColumn()\n\n  var column \u003d check_cell.match(/[0-9]{1,}/)[0]\n  var row \u003d check_cell.match(/[A-Za-z]{1,}/)[0]\n  var row_num \u003d 0\n  for (var i \u003d 0; i \u003c row.length; i++){\n    row_num \u003d row_num + row[i].charCodeAt(0) - \"A\".charCodeAt(0) + 1\n  }\n\n  var rng\u003dsh.getRange(1, row_num, bottom_end, 1)\n  if (cell_value \u003d\u003d value){\n    rng.setBackground(color);　//セル色を設定\n  }\n  else{\n    rng.setBackground(null);　//セル色を設定\n  }\n  \n}\n\nfunction show_sample(){\nvar sample \u003d `function sample_chage_color(){ \n  // 以下を変更\n  // --- ここから ---\n  var num_sheet \u003d 1 // n番目のセル\n  var value \u003d \"hoge\" // チェックする値\n  var check_cell \u003d \"A20\" // チェックするセル (A1形式)\n  var color \u003d \"#FF00FF\" // 変更する色 (#RRGGBB, BLUE など)\n  // --- ここまで --- \n\n  var ss \u003d SpreadsheetApp.getActiveSpreadsheet();　//アクティブなスプレッドシートを取得\n  var sh \u003d ss.getSheets()[num_sheet - 1] // 1番目のシートを指定\"\n  // チェックするセルの行を変更\n  // チェックするセルの行を変更\n  change_cell_color.change_column_color_from_cell(sh, value, check_cell, color)\n  // チェックするセルの列を変更\n  change_cell_color.hange_row_color_from_cell(sh, value, check_cell, color)`\n  console.log(sample)\n}"}]}